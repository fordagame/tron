var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Tron;(function(n){var t=function(t){function i(n,i){var r=t.call(this,i)||this;return r.sandbox=n,r}return __extends(i,t),i.prototype.getName=function(){var n=this.sandbox.getService("users").getUser();return n.name},i.prototype.createGame=function(t){var i=new n.GameOptions,r;i.numberOfPlayers=t;i.type=n.GameType.Tron;r=this.sandbox.getService("game");r.createGame(i,this.gameCreated.bind(this))},i.prototype.gameCreated=function(n){window.location.hash="#tron/"+n},i}(dcore.plugins.mvp.Presenter);n.GamesPresenter=t})(Tron||(Tron={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(n,i){var r=t.call(this,i)||this;return r.sandbox=n,r.players=[],r}return __extends(i,t),i.prototype.destroy=function(){this.view.destroy()},i.prototype.updateDirection=function(n){var t=this.sandbox.getService("websocket");t.updateGameState(this.gameId,n)},i.prototype.updateGameData=function(n){this.playerGameData=n;this.view.setGameData(n)},i.prototype.updateGameState=function(t){var u,r,i;if(t.state==n.GameState.WaitingForPlayers&&(u=this.players.length,u!=t.players.length&&(this.players=t.players,this.view.updatePlayers(this.players))),t.state>n.GameState.WaitingForPlayers){for(r=[],i=0;i<this.players.length;i++)r[this.players[i].id]=this.players[i].position;for(i=0;i<t.newCoordinates.length;i++)this.view.drawInCanvas(t.lastCoordinates[i].x,t.lastCoordinates[i].y,r[t.lastCoordinates[i].id]-1,!1);for(i=0;i<t.newCoordinates.length;i++)console.info(t.newCoordinates[i]),this.view.drawInCanvas(t.newCoordinates[i].x,t.newCoordinates[i].y,r[t.newCoordinates[i].id]-1,!0)}t.state==n.GameState.Ended&&alert(t.winnerName)},i}(dcore.plugins.mvp.Presenter);n.TronPresenter=t}(Tron||(Tron={}));