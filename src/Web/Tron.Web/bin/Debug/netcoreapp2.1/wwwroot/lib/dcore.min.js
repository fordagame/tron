var __extends,dcore;(function(n){"use strict";var t=function(){function n(n,t){if(!n||!t)throw new Error("Missing core or module instance ID.");this.core=n;this.moduleInstanceId=t}return n.prototype.subscribe=function(n,t){return this.core.subscribe(n,t)},n.prototype.publish=function(n,t){return this.core.publish(n,t),this},n.prototype.publishSynchronize=function(n,t){return this.core.publishSynchronize(n,t),this},n.prototype.start=function(n,t){return this.core.start(n,t),this},n.prototype.stop=function(n,t){return this.core.stop(n,t),this},n}();n.DefaultSandbox=t})(dcore||(dcore={})),function(n){"use strict";function t(n,t,i){var r=!1;switch(n){case"array":r=!Array.isArray(t);break;default:r=typeof t!==n||t===null}if(r)throw new TypeError(i);}function r(n){for(var f,e,r,t,o,s,h=[],u=1;u<arguments.length;u++)h[u-1]=arguments[u];if(!this.state.isRunning)throw new Error("Core is not running.");if(f=this.hooks[n],Array.isArray(f)){for(e=arguments.length,r=new Array(e-1),t=1;t<e;t++)r[t-1]=arguments[t];for(t=0,o=f.length;t<o;t++)try{f[t].apply(null,r)}catch(c){s=r.length>0?r.join(", "):"none";console.error("Plugin execution failed on hook "+i[n]+". Arguments: "+s+". Message: "+c)}}}function o(n,t){u.call(this.subscribers,n)||(this.subscribers[n]={});var i="t"+ ++e;return this.subscribers[n][i]=t,i}function s(n){return new f(n)}var u=Object.prototype.hasOwnProperty,e=0,i,f;(function(n){n[n.Core_DOMReady=0]="Core_DOMReady";n[n.Core_ModuleDestroy=1]="Core_ModuleDestroy";n[n.Core_ModuleInit=2]="Core_ModuleInit";n[n.Core_ModuleRegister=3]="Core_ModuleRegister";n[n.Core_Publish=4]="Core_Publish";n[n.Core_Subscribe=5]="Core_Subscribe";n[n.Core_Unsubscribe=6]="Core_Unsubscribe"})(i=n.HookType||(n.HookType={}));f=function(){function f(t,i){i===void 0&&(i=!0);this.subscribers={};this.modules={};this.hooks={};this.Sandbox=typeof t=="function"?t:n.DefaultSandbox;this.state={isDebug:!!i,isRunning:!1}}return f.prototype.subscribe=function(n,f){var l="Subscribing failed:",e,h,a,c,v,s;for(t("function",f,l+" message handler should be a function."),t("array",n,l+" topics should be passed as an array of strings."),r.call(this,i.Core_Subscribe,n),e={},h=0,a=n.length;h<a;h++)c=n[h],v=o.call(this,c,f),e[c]=v;return s=this,{destroy:function(n){if(arguments.length===0){Object.keys(e).forEach(function(n){r.call(s,i.Core_Unsubscribe,n);var t=e[n];delete s.subscribers[n][t]});return}if(u.call(e,n)){r.call(s,i.Core_Unsubscribe,n);var t=e[n];delete s.subscribers[n][t]}}}},f.prototype.publish=function(n,t){if(u.call(this.subscribers,n)){r.call(this,i.Core_Publish,n,t);var f=this.subscribers[n];Object.keys(f).forEach(function(i){var r=f[i];try{setTimeout(function(){return r(n,t)},0)}catch(u){setTimeout(function(){console.info(n+" message publishing failed. Subscriber:");console.info(r)},0)}})}},f.prototype.publishSynchronize=function(n,t){if(u.call(this.subscribers,n)){r.call(this,i.Core_Publish,n,t);var f=this.subscribers[n];Object.keys(f).forEach(function(i){var r=f[i];try{r(n,t)}catch(u){console.info(n+" message publishing failed. Subscriber:");console.info(r)}})}},f.prototype.register=function(n,u){var f=n+" registration failed:",e;return t("string",n,f+" module ID must be a string."),t("string",n,f+" module ID must be a string."),t("undefined",this.modules[n],f+" module with such id has been already registered."),e=u(new this.Sandbox(this,n)),t("function",e.init,f+" module does not implement init method."),t("function",e.destroy,f+" module does not implement destroy method."),r.call(this,i.Core_ModuleRegister,n,u),this.modules[n]={create:u,instances:{}},this},f.prototype.start=function(n,f){var e=this.modules[n],s,o,h;return(f=f||{},s=n+" initialization failed:",t("object",e,s+" module not found."),t("object",f,s+" module options must be an object."),o=f.instanceId||n,u.call(e.instances,o))?this:(r.call(this,i.Core_ModuleInit,n,f),h=e.create(new this.Sandbox(this,o)),e.instances[o]=h,h.init(f),this)},f.prototype.stop=function(n,t){var f=this.modules[n],e=t||n;return f&&u.call(f.instances,e)&&(r.call(this,i.Core_ModuleDestroy,n,t),f.instances[e].destroy(),delete f.instances[e]),this},f.prototype.listModules=function(){return Object.keys(this.modules)},f.prototype.hook=function(n,i){var r="Hook plugin failed:";return t("number",n,r+" hook type should be an HookType enum."),t("function",i,r+" plugin should be a function."),Array.isArray(this.hooks[n])||(this.hooks[n]=[]),this.hooks[n].push(i),this},f.prototype.run=function(n){if(!this.state.isRunning)return this.beforeRunAction=n,this._onDomReady=this._onDomReady.bind(this),document.readyState.toString()==="complete"||document.readyState.toString()==="interactive"||document.readyState.toString()==="loaded"?this._onDomReady(null):document.addEventListener("DOMContentLoaded",this._onDomReady),this},f.prototype._onDomReady=function(){document.removeEventListener("DOMContentLoaded",this._onDomReady);this.state.isRunning=!0;typeof this.beforeRunAction=="function"&&this.beforeRunAction();r.call(this,i.Core_DOMReady)},f}();n.Instance=f;n.createOne=s}(dcore||(dcore={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t;(function(n){"use strict";function i(n){var i,r;if(typeof n!="object"||n===null)return null;i=new t;for(r in i)n[r]=i[r];return n}n.ModelEvents={Change:"change",Destroy:"destroy"};n.asModel=i;var t=function(){function t(){this.listeners={}}return t.prototype.on=function(n,t,i){return n?(this.listeners[n]=this.listeners[n]||[],this.listeners[n].push({handler:t,context:i}),!0):!1},t.prototype.off=function(n,t,i){for(var u,r=this.listeners[n]||[],f=0,e=r.length;f<e;f++)if(u=r[f],u.handler===t&&u.context===i)return u=r[e-1],r.length--,!0;return!1},t.prototype.notify=function(n,t){Array.isArray(this.listeners[n])&&this.listeners[n].slice(0).forEach(function(n){return n.handler.call(n.context,t)})},t.prototype.change=function(){this.notify(n.ModelEvents.Change,this)},t.prototype.destroy=function(){this.notify(n.ModelEvents.Destroy,this)},t}();n.Model=t})(t=n.mvp||(n.mvp={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){var t;(function(n){var t;(function(n){"use strict";function t(t){this.notify(n.CollectionEvents.UpdatedItem,t)}function i(n){this.removeRange([n])}n.CollectionEvents={AddedItems:"added-items",DeletedItems:"deleted-items",UpdatedItem:"updated-item"};var r=function(r){function u(n){var t=r.call(this)||this;return t.modelList=[],Array.isArray(n)&&t.addRange(n),t}return __extends(u,r),Object.defineProperty(u.prototype,"size",{get:function(){return this.modelList.length},enumerable:!0,configurable:!0}),u.prototype.add=function(n){n&&this.addRange([n])},u.prototype.addRange=function(r){var u=this;Array.isArray(r)&&(r.forEach(function(r){r.on(n.ModelEvents.Change,t,u);r.on(n.ModelEvents.Destroy,i,u);u.modelList.push(r)}),this.notify(n.CollectionEvents.AddedItems,r))},u.prototype.remove=function(n){this.removeRange([n])},u.prototype.removeRange=function(r){var f,e,s,u,o,h;if(Array.isArray(r)){for(f=[],e=0,s=r.length;e<s;e++)(u=r[e],o=this.modelList.indexOf(u),o<0)||(u.off(n.ModelEvents.Change,t,this),u.off(n.ModelEvents.Destroy,i,this),this.modelList[o]=this.modelList[this.size-1],this.modelList.length--,f.push(u));h=f.length>0;h&&this.notify(n.CollectionEvents.DeletedItems,f)}},u.prototype.clear=function(){this.removeRange(this.toArray())},u.prototype.contains=function(n){return this.modelList.indexOf(n)>=0},u.prototype.any=function(){return this.size>0},u.prototype.toArray=function(){return this.modelList.slice(0)},u.prototype.forEach=function(n,t){this.modelList.forEach(n,t)},u}(n.Model);n.Collection=r})(t=n.mvp||(n.mvp={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={}));Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(n){for(var i=(this.document||this.ownerDocument).querySelectorAll(n),t=i.length;--t>=0&&i.item(t)!==this;)continue;return t>-1}),function(n){var t;(function(n){var t;(function(n){"use strict";var t=Object.prototype.hasOwnProperty,i=function(){function n(n,t,i,r,u){this.type=n;this.selector=t;this.listener=i;this.useCapture=r;this.context=u}return n.prototype.handleEvent=function(n){var t=n.target;do{if(!t.matches(this.selector)){t=t.parentElement;continue}n.delegateTarget=t;this.listener.call(this.context,n);return}while(t&&t!==this.context.root)},n}(),r=function(){function n(n){this.eventListeners={};this.root=n}return n.prototype.render=function(){return this.root},n.prototype.addEventListeners=function(n){var t=this;return Array.isArray(n)&&n.forEach(function(n){return t.addEventListener(n)}),this},n.prototype.addEventListener=function(n){var u,r,f;if(typeof n!="object"||n===null)throw new TypeError("Listener config must be passed as object.");if(u=n.type,typeof u!="string")throw new TypeError("Event type must be a string.");return(r=new i(u,n.selector,n.listener,!!n.useCapture,this),f=u+" "+r.selector+" "+r.useCapture,t.call(this.eventListeners,f))?this:(r.handleEvent=r.handleEvent.bind(r),this.root.addEventListener(u,r.handleEvent,r.useCapture),this.eventListeners[f]=r,this)},n.prototype.resetEvents=function(){this.eventListeners={}},n.prototype.destroy=function(){var n=this;Object.keys(this.eventListeners).forEach(function(t){var i=n.eventListeners[t];n.root.removeEventListener(i.type,i.handleEvent,i.useCapture);delete n.eventListeners[t]});this.eventListeners={};this.root=null},n}();n.View=r})(t=n.mvp||(n.mvp={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function t(n){this._model=null;this._view=null;this._modelHandlers={};this._view=n}return Object.defineProperty(t.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return this._model},set:function(t){var i=this,r,u;this.model!==t&&(r=this.model instanceof n.Model,u=t instanceof n.Model,Object.keys(this._modelHandlers).forEach(function(n){var f=i._modelHandlers[n];if(r&&i.model.off(n,f,i),u)t.on(n,f,i)}),this._model=t)},enumerable:!0,configurable:!0}),t.prototype.onModel=function(n,t){return n&&t&&(this._modelHandlers[n]=t),this},t.prototype.render=function(){return this.view.render(this.model)},t.prototype.destroy=function(){this.model=null;this._view.destroy();this._view=null},t}();n.Presenter=t})(t=n.mvp||(n.mvp={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){"use strict";n.DefaultSandbox.prototype.asMVPModel=function(){return null};var t=n.plugins.mvp;n.Instance.prototype.useMVP=function(){var n=this;n.mvp||(n.mvp={Model:t.Model,asMVPModel:t.asModel,ModelEvents:t.ModelEvents,Collection:t.Collection,CollectionEvents:t.CollectionEvents,View:t.View,Presenter:t.Presenter},n.Sandbox.prototype.asMVPModel=t.asModel)}}(dcore||(dcore={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(){this.questionMarkIndex=-1;this.url="";this.tokens=[];this.queryParams=[]}return Object.defineProperty(n.prototype,"value",{get:function(){return this.url},set:function(n){n=n||"";this.url=n;this.questionMarkIndex=n.indexOf("?");this.queryParams=[];this.tokens=[];this.populateQueryParams();this.populateTokens()},enumerable:!0,configurable:!0}),n.prototype.anyQueryParams=function(){return this.questionMarkIndex>-1},n.prototype.populateQueryParams=function(){var n=this;this.anyQueryParams()&&(this.queryParams=this.value.substring(this.questionMarkIndex+1).split("&").map(function(t){return n.parseQueryParam(t)}))},n.prototype.parseQueryParam=function(n){var t=n.split("=");return{key:t[0],value:t[1]||""}},n.prototype.populateTokens=function(){var n=this.getValueWithoutQuery();this.tokens=n.split("/").filter(function(n){return n!==""})},n.prototype.getValueWithoutQuery=function(){return this.anyQueryParams()?this.value.substring(0,this.value.length-(this.value.length-this.questionMarkIndex)):this.value},n}();n.UrlHash=t})(t=n.routing||(n.routing={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=/{([a-zA-Z]+)}/,i=function(){function n(n,t){this.tokens=[];var i="Route registration failed:";if(typeof n!="string")throw new TypeError(i+" pattern should be non empty string.");if(typeof t!="function")throw new TypeError(i+" callback should be a function.");this.pattern=n;this.callback=t;this.populateTokens()}return n.prototype.getTokens=function(){return this.tokens.slice(0)},n.prototype.equals=function(n){var t,r,i,u;if(this.tokens.length!==n.tokens.length)return!1;for(t=0,r=this.tokens.length;t<r;t++)if((i=this.tokens[t],u=n.tokens[t],!i.isDynamic)&&i.name.toLowerCase()!==u.toLowerCase())return!1;return!0},n.prototype.start=function(n){var t=this.getParamsFromUrl(n);this.callback&&this.callback(t)},n.prototype.populateTokens=function(){var n=this;this.tokens=[];this.pattern.split("/").forEach(function(t){t!==""&&n.tokens.push(n.parseToken(t))})},n.prototype.parseToken=function(n){var i=t.exec(n),r=!!i;return{name:r?i[1]:n,isDynamic:r}},n.prototype.getParamsFromUrl=function(n){var t=this.getQueryParamsFromUrl(n);return this.tokens.forEach(function(i,r){i.isDynamic&&(t[i.name]=n.tokens[r])}),t},n.prototype.getQueryParamsFromUrl=function(n){var t={};return n.queryParams.forEach(function(n){return t[n.key]=n.value}),t},n}();n.Route=i})(t=n.routing||(n.routing={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){var t;(function(n){var t;(function(n){"use strict";function t(){for(var t,n=0,i=this.routes.length;n<i;n++)if(t=this.routes[n],t.equals(this.urlHash))return t;return null}function i(n){window.history.replaceState(null,null,window.location.pathname+"#"+this.defaultUrl);this.urlHash.value=this.defaultUrl;var i=t.call(this);i?i.start(this.urlHash):console.warn("No route handler for "+n)}var r=function(){function r(){this.routes=[];this.urlHash=new n.UrlHash;this.defaultUrl=null}return r.prototype.register=function(t,i){if(this.routes.some(function(n){return n.pattern===t}))throw new Error("Route "+t+" has been already registered.");return this.routes.push(new n.Route(t,i)),this},r.prototype.startRoute=function(n){this.urlHash.value=n;var r=t.call(this);if(r){r.start(this.urlHash);return}typeof this.defaultUrl=="string"?i.call(this,n):console.warn("No route matches "+n)},r.prototype.getRoutes=function(){return this.routes.map(function(n){return n.pattern})},r.prototype.hasRoutes=function(){return this.routes.length>0},r}();n.RouteConfig=r})(t=n.routing||(n.routing={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){"use strict";var t=n.plugins.routing;n.Instance.prototype.useRouting=function(){var i=this;i.routing||(i.routing=new t.RouteConfig,i.hook(n.HookType.Core_DOMReady,function(){if(i.routing.hasRoutes()){var n=window;i.routing.startRoute(n.location.hash.substring(1));n.addEventListener("hashchange",function(){i.routing.startRoute(n.location.hash.substring(1))})}}))}}(dcore||(dcore={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(){this.services={}}return n.prototype.add=function(n,t){if(typeof n!="string"||n==="")throw new TypeError(n+" service registration failed: ID must be non empty string.");if(typeof t!="function")throw new TypeError(n+" service registration failed: creator must be a function.");if(this.services[n])throw new TypeError(n+" service registration failed: a service with such id has been already added.");return this.services[n]=t,this},n.prototype.get=function(n){var t=this.services[n];if(!t)throw new ReferenceError(n+" service was not found.");return t()},n}();n.ServiceConfig=t})(t=n.services||(n.services={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){"use strict";n.DefaultSandbox.prototype.getService=function(){return null};var t=n.plugins.services;n.Instance.prototype.useServices=function(){var n=this;n.services||(n.services=new t.ServiceConfig,n.Sandbox.prototype.getService=function(n){return this.core.services.get(n)})}}(dcore||(dcore={})),function(n){"use strict";n.DefaultSandbox.prototype.ajax=function(){return null};n.Instance.prototype.useAjax=function(){var n=this;n.ajax||(n.ajax=function(n,t){var r={method:t.method||"GET",contentType:t.contentType||"application/json",responseType:t.responseType||"",converter:t.converter||function(n){return n},success:t.success,error:t.error||function(){return},data:t.data||""},i=new XMLHttpRequest;i.open(r.method,n,!0);r.contentType!="empty"&&i.setRequestHeader("Content-type",r.contentType);i.responseType=r.responseType;i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE){i.responseURL&&i.responseURL.indexOf("Account/Login")!=-1&&(window.location.href="/Account/Login");switch(i.status){case 200:r.success(r.converter(i.responseText));break;default:r.error("Service error.")}}};i.send(r.data)},n.Sandbox.prototype.ajax=function(n,t){return this.core.ajax(n,t)})}}(dcore||(dcore={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n,t){this.resources=[];this.resourceLoader=n;this.currentLanguage=t;this.loadedResources=[];this.onSuccessFunctions=[]}return n.prototype.loadResource=function(n,t){this.onSuccessFunctions[n]||(this.onSuccessFunctions[n]=[]);this.onSuccessFunctions[n].length==0&&this.resourceLoader.loadLanguageResource(n,this.currentLanguage,this.loadResourcesSuccess.bind(this));this.onSuccessFunctions[n].push(t)},n.prototype.changeLanguage=function(n){this.currentLanguage=n;for(var t in this.loadedResources)this.loadedResources[t]="notloaded"},n.prototype.loadResourcesSuccess=function(n,t){this.resources[n]=t;this.loadedResources[n]="loaded";for(var i=0;i<this.onSuccessFunctions[n].length;i++)this.onSuccessFunctions[n][i](n);this.onSuccessFunctions[n]=[]},n.prototype.translate=function(n,t){if(this.resources[n])return this.resources[n][t]},n.prototype.getResources=function(n){return this.resources[n]},n.prototype.getAllResources=function(){return this.resources},n.prototype.isResourceLoaded=function(n){return this.loadedResources[n]=="loaded"},n.prototype.destroy=function(){},n}();n.Localization=t})(t=n.localization||(n.localization={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){n.DefaultSandbox.prototype.getLocalization=function(){return null};n.Instance.prototype.useLocalization=function(t,i){var r=this;r.localization&&r.localization.destroy();r.localization=new n.plugins.localization.Localization(t,i);r.Sandbox.prototype.getLocalization=function(){return r.localization}}}(dcore||(dcore={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n,t){this.templates=[];this.templateDictionary=n;this.templateNameFormat=t}return n.prototype.getTemplate=function(n){return this.templates[n]||(this.templates[n]=this.templateDictionary[this.templateNameFormat(n)]),this.templates[n]},n.prototype.loadTemplates=function(n){n()},n.prototype.destroy=function(){this.templates=[]},n}();n.TemplateResolver=t})(t=n.templates||(n.templates={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){n.DefaultSandbox.prototype.getTemplate=function(){return null};n.Instance.prototype.useTemplateResolver=function(n){var t=this;t.templates&&t.templates.destroy();t.templates=n;t.Sandbox.prototype.getTemplate=function(n){return t.templates.getTemplate(n)}}}(dcore||(dcore={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i;(function(t){var i=function(n){function t(t,i){var r=n.call(this,t)||this;return r.template=i,r}return __extends(t,n),t.prototype.render=function(t){var i=n.prototype.render.call(this,t);return this.template&&(i.innerHTML=this.template.call(this,t)),i},t}(n.plugins.mvp.View);t.BaseView=i})(i=t.mvp_extension||(t.mvp_extension={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){var t;(function(t){var i;(function(t){var i=function(n){function t(){return n.call(this)||this}return __extends(t,n),t}(n.plugins.mvp.Model);t.BaseModel=i})(i=t.mvp_extension||(t.mvp_extension={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){"use strict";var t=n.plugins.mvp_extension,i=n.plugins.mvp_extension;n.Instance.prototype.useMVPExtended=function(){var n=this;n.mvpExt||(n.mvpExt={baseView:t.BaseView,baseModel:i.BaseModel})}}(dcore||(dcore={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n){this.loadedDependencies=[];this.concreteResolvers=n}return n.prototype.require=function(n,t){if(n.length==0)t(!0,"");else{var i=n.pop(),u=this,r=this.concreteResolvers[i.name];r?r.resolve(i.options,function(){u.require(n,t)}):t(!1,"Depdencny resolver for "+i.name+" was not found")}},n.prototype.destroy=function(){},n}();n.DependencyLoader=t})(t=n.dependency||(n.dependency={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){n.DefaultSandbox.prototype.getDependencyLoader=function(){return null};n.Instance.prototype.useDependencyLoader=function(t){var i=this;i.dependency&&i.dependency.destroy();i.dependency=new n.plugins.dependency.DependencyLoader(t);i.Sandbox.prototype.getDependencyLoader=function(){return i.dependency}}}(dcore||(dcore={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n){this.webSocketCheckTimeoutInterval=6e4;this.onSocketMessageReceived=n}return n.prototype.init=function(n){try{this.webSocketHandlerUrl=n;var t=window.location.protocol=="https:"?"wss":"ws",i=location.hostname+(location.port?":"+location.port:""),r=t+"://"+i+"/"+n,u=this;this.socket=new WebSocket(r);this.socket.onopen=function(){console.log("open "+new Date)};this.socket.onmessage=function(n){u.onSocketMessageReceived(n)};this.socket.onerror=function(n){console.log("Error: "+n)};this.socket.onclose=function(){console.info("close "+new Date)};this.webSocketStatusChecker==null&&(this.webSocketStatusChecker=setTimeout(this.CheckForWebSocketConnection.bind(this),this.webSocketCheckTimeoutInterval))}catch(f){console.info(f);this.webSocketStatusChecker==null&&(this.webSocketStatusChecker=setTimeout(this.CheckForWebSocketConnection.bind(this),this.webSocketCheckTimeoutInterval))}},n.prototype.CheckForWebSocketConnection=function(){this.socket.readyState>1&&(clearTimeout(this.webSocketStatusChecker),this.webSocketStatusChecker=null,this.init(this.webSocketHandlerUrl));this.webSocketStatusChecker=setTimeout(this.CheckForWebSocketConnection.bind(this),this.webSocketCheckTimeoutInterval)},n.prototype.send=function(n,t){if(t===void 0&&(t=0),!(t>5)){if(this.socket.readyState==1){this.socket.send(n);return}setTimeout(this.send.bind(this,n,t+1),1500)}},n.prototype.close=function(){this.socket.close();this.webSocketStatusChecker!=null&&(clearTimeout(this.webSocketStatusChecker),this.webSocketStatusChecker=null)},n}();n.WebSocketManager=t})(t=n.websockets||(n.websockets={}))})(t=n.plugins||(n.plugins={}))}(dcore||(dcore={})),function(n){"use strict";var t=n.plugins.websockets;n.Instance.prototype.useWebSocket=function(){var n=this,i;n.websocket||(i=function(t){n.publish("WebSocketDataReceived",t)},n.websocket=new t.WebSocketManager(i))}}(dcore||(dcore={}));